All files were downloaded from GTDB Release 220
Unzip bac_120_metadata.tsv.gz to preferred directory and follow the commands below

1) cut -f20, 53 bac_120_metadata_r220.tsv > GTDB.tsv
This extracts the columns containing just the NCBI Biosample information and GTDB taxononmy information.

2) The filtered Biosample list from Progenomes must be parsed to only include the Biosample information in the "SAMN****" format.
This is done with the following commmand sed 's/^[^.]*\.//' Biosample_IDs_filtered.txt > GTDBFORMATTED_Biosample_IDs.txt 

3) grep -F -f GTDBFORMATTED_Biosample_IDs.txt GTDB.tsv  > filtered_GTDB.tsv
This command then filters the GTDB biosamples to only include entries which overlap with our progenomes biosamples.

4) tail -n +2 data.tsv > data_no_header.tsv
This command will remove the headers on our GTDB taxonomy file. The aim is to seperate the taxonomic information (Phylum, Genus etc) into separate columns for more efficient use in subsequent code.

5) awk -F'\t' '{
    n = split($1, arr, ";")
    printf $2
    for (i = 1; i <= n; i++) {
        printf "\t" arr[i]
    }
    for (i = n+1; i <= NF; i++) {
        printf "\t" $(i+1)
    }
    print ""
}' filtered_GTDB_no_header.tsv > GTDB_split_taxonomy_data.tsv

This for loop in awk divides the taxonomy column into multiple columns with the ; as the divider.

6) echo -e "ncbi_biosample\tDomain\tPhylum\tClass\tOrder\tFamily\tGenus\tSpecies" | cat - GTDB_split_taxonomy_data.tsv > GTDB_taxonomy.tsv
This command will add the headers for each distinct column.

7) awk -F'\t' '{
    for (i = NF - 6; i <= NF; i++) {
        $i = substr($i, 4)
    }
    print $0
}' GTDB_taxonomy.tsv > GTDB_taxonomy_final.tsv

This final command removes the first three characters from each GTDB taxonomy column, allowing for easier subsequent reading.

